ODS：全量，增量，增量及更新，不变化

DWD：
 + 维度表dim：
   + 全量：数据量小，按天快照分区（用户信息、商品信息、活动信息）
   + 拉链表：不分区，有可能修改，但修改频率并不高，属于缓慢变化维度（记录某些字段开始及结束时间）
     + 需要先初始化。使用 new 表 left join old 表，判断 id 是否为空和截至时间是否为开区间，则设置截止时间为目标日，最后 union all old 数据.
   + 无变化：地区等信息
 + 事实表fact：
   + 事务型快照事实表：数据插入后不改变，增量更新，按天分区（订单记录，支付记录）
   + 周期型快照事实表：每日全量数据快照，较讲究时效性，时间太久了的意义不大，可 以删除以前的数据（每日销售额、每月余额）
   + 累积型快照事实表：跟踪业务事实的变化，一般是伴随着时间（如订单：创建时间、支付时间、取消时间、完成时间、退款时间）。
     + hive实现：在按天分区的情况下，获取ODS层有变化且为目标日的日期（事件的初始日期即可，new 里面的数据会补齐中间的数据）为 daylist，获取事实表历史分区数据中在 daylist 的所有数据为 old，获取ODS层目标日所有数据为 new，使用 new 和 old 做 full outer join（on id 相等的条件）,最后动态分区 overwrite。
 + 普通行为事件及其它表
 
DWS：基于 DWD 的当天行为统计，宽表，统计一些次数、数量、金额等，使用 DWD 的事实表 join 维度表或事实表 union all 事实表实现（不同表字段使用0填充，变为宽表），按天分区

DWT：基于 DWS 的主题宽表（会员、商品、活动、设备），统计首次时间、末次时间、当日次数、累计次数、最近N日XX等，使用 old 表 full outer join DWS 的 new 分区数据（if+nvl）。最近N日使用 date_add('yyyy-MM-dd',-N)选取历史数据后再 group by 统计（sum(if())）。不分区。

ADS：统计日周月的各种指标，如活跃新增、留存、漏斗分析等